separate(from_to, c("from", "to"))
name_vec <- c(unique(flow2$from_PA), unique(flow2$to_PA))
flow2 <- data %>%
select('DAY_TYPE','TIME_PER_HOUR','Planning_Area_Origin','Planning_Area_Destination','BusStopCode_x','BusStopCode_y','TOTAL_TRIPS','Latitude_Origin','Longitude_Origin','Latitude_Destination','Longitude_Destination') %>%
unite(from_toPA, Planning_Area_Origin,Planning_Area_Destination, sep = ":", remove=FALSE) %>%
group_by(from_toPA)%>%
summarise(Frequency = sum(TOTAL_TRIPS))%>%
separate(from_toPA, c("from_PA", "to_PA"),sep = ":")
flow2 <- data %>%
dplyr::select('DAY_TYPE','TIME_PER_HOUR','Planning_Area_Origin','Planning_Area_Destination','BusStopCode_x','BusStopCode_y','TOTAL_TRIPS','Latitude_Origin','Longitude_Origin','Latitude_Destination','Longitude_Destination') %>%
unite(from_toPA, Planning_Area_Origin,Planning_Area_Destination, sep = ":", remove=FALSE) %>%
group_by(from_toPA)%>%
summarise(Frequency = sum(TOTAL_TRIPS))%>%
separate(from_toPA, c("from_PA", "to_PA"),sep = ":")
#flow3 <- flow2 %>%
common <- c()
flow2 <- flow2[flow2$from_PA != flow2$to_PA,]
flow2 <- flow2[flow2$from_PA == c("ANG MO KIO","PUNGGOL","HOUGANG", "WOODLANDS","BEDOK"),]
flow2$Frequency_sqrt <- sapply(flow2$Frequency, function(x) sqrt(x))
print(flow2)
# flow2$from_PA <- sapply(flow2$from_PA, function(x) paste('from_', x))
# flow2$to_PA <- sapply(flow2$to_PA, function(x) paste('to_', x))
name_vec <- c(unique(flow2$from_PA), unique(flow2$to_PA))
#name_vec_from <-  lapply(name_vec, function(x) paste('to_', x))
#name_vec <- c(unique(name_vec))
#print(name_vec)
nodes <- data.frame(name = name_vec, id = 0:22)
#nodes_from$name <-  sapply(nodes$name, function(x) paste('from_', x))
#nodes_to$name  <-  sapply(nodes$name, function(x) paste('from_', x))
#nodes_from_to <- rbind(nodes_from, nodes_to)
#
class(flow2)
print(flow2)
#print(nodes_from_to)
print(class(flow2))
# links <- flow2 %>%
#   left_join(nodes, by = c('from_PA' = 'name'))  %>%
#   rename(from_PA = id) %>%
#   left_join(nodes, by = c('to_PA' = 'name')) %>%
#   rename(to_PA = id)
links <- flow2 %>%
left_join(nodes,flow2, by=c('from_PA'='name')) %>%
rename(from_PA_id = id) %>%
left_join(nodes,flow2, by=c('to_PA'='name')) %>%
rename(to_PA_id = id)
forcenetwork <- forceNetwork(Links = links, Nodes = nodes, Source = 'from_PA_id', Target = 'to_PA_id',
Value = 'Frequency_sqrt', NodeID = 'name', Group = 'id', zoom = TRUE)
forcenetwork <- htmlwidgets::prependContent(forcenetwork,htmltools::tags$h1("Interactive Node flow Origin to Destination by PA"))
forcenetwork
name_vec <- c(unique(flow2$from_PA), unique(flow2$to_PA))
#name_vec_from <-  lapply(name_vec, function(x) paste('to_', x))
#name_vec <- c(unique(name_vec))
#print(name_vec)
nodes <- data.frame(name = name_vec, id = 0:22)
#nodes_from$name <-  sapply(nodes$name, function(x) paste('from_', x))
#nodes_to$name  <-  sapply(nodes$name, function(x) paste('from_', x))
#nodes_from_to <- rbind(nodes_from, nodes_to)
#
class(flow2)
print(flow2)
#print(nodes_from_to)
print(class(flow2))
# links <- flow2 %>%
#   left_join(nodes, by = c('from_PA' = 'name'))  %>%
#   rename(from_PA = id) %>%
#   left_join(nodes, by = c('to_PA' = 'name')) %>%
#   rename(to_PA = id)
links <- flow2 %>%
left_join(nodes,flow2, by=c('from_PA'='name')) %>%
rename(from_PA_id = id) %>%
left_join(nodes,flow2, by=c('to_PA'='name')) %>%
rename(to_PA_id = id)
print(nodes)
forcenetwork <- forceNetwork(Links = links, Nodes = nodes, Source = 'from_PA_id', Target = 'to_PA_id',
Value = 'Frequency_sqrt', NodeID = 'name', Group = 'id', zoom = TRUE)
forcenetwork <- htmlwidgets::prependContent(forcenetwork,htmltools::tags$h1("Interactive Node flow Origin to Destination by PA"))
forcenetwork
View(flow2)
name_vec <- c(unique(flow2$from_PA), unique(flow2$to_PA))
print(flow2$from_PA)
print(name_vec)
#name_vec_from <-  lapply(name_vec, function(x) paste('to_', x))
#name_vec <- c(unique(name_vec))
#print(name_vec)
nodes <- data.frame(name = name_vec, id = 0:22)
#nodes_from$name <-  sapply(nodes$name, function(x) paste('from_', x))
#nodes_to$name  <-  sapply(nodes$name, function(x) paste('from_', x))
#nodes_from_to <- rbind(nodes_from, nodes_to)
#
class(flow2)
print(flow2)
#print(nodes_from_to)
print(class(flow2))
# links <- flow2 %>%
#   left_join(nodes, by = c('from_PA' = 'name'))  %>%
#   rename(from_PA = id) %>%
#   left_join(nodes, by = c('to_PA' = 'name')) %>%
#   rename(to_PA = id)
links <- flow2 %>%
left_join(nodes,flow2, by=c('from_PA'='name')) %>%
rename(from_PA_id = id) %>%
left_join(nodes,flow2, by=c('to_PA'='name')) %>%
rename(to_PA_id = id)
print(nodes)
forcenetwork <- forceNetwork(Links = links, Nodes = nodes, Source = 'from_PA_id', Target = 'to_PA_id',
Value = 'Frequency_sqrt', NodeID = 'name', Group = 'id', zoom = TRUE)
forcenetwork <- htmlwidgets::prependContent(forcenetwork,htmltools::tags$h1("Interactive Node flow Origin to Destination by PA"))
forcenetwork
View(links)
View(links)
name_vec <- c(unique(flow2$from_PA), unique(flow2$to_PA))
print(flow2$from_PA)
print(name_vec)
#name_vec_from <-  lapply(name_vec, function(x) paste('to_', x))
#name_vec <- c(unique(name_vec))
#print(name_vec)
nodes <- data.frame(name = name_vec, id = 0:22)
#nodes_from$name <-  sapply(nodes$name, function(x) paste('from_', x))
#nodes_to$name  <-  sapply(nodes$name, function(x) paste('from_', x))
#nodes_from_to <- rbind(nodes_from, nodes_to)
#
class(flow2)
print(flow2)
#print(nodes_from_to)
print(class(flow2))
# links <- flow2 %>%
#   left_join(nodes, by = c('from_PA' = 'name'))  %>%
#   rename(from_PA = id) %>%
#   left_join(nodes, by = c('to_PA' = 'name')) %>%
#   rename(to_PA = id)
links <- flow2 %>%
left_join(nodes,flow2, by=c('from_PA'='name')) %>%
rename(from_PA_id = id) %>%
left_join(nodes,flow2, by=c('to_PA'='name')) %>%
rename(to_PA_id = id)
print(nodes)
class(nodes)
forcenetwork <- forceNetwork(Links = links, Nodes = nodes, Source = 'from_PA_id', Target = 'to_PA_id',
Value = 'Frequency_sqrt', NodeID = 'name', Group = 'id', zoom = TRUE)
forcenetwork <- htmlwidgets::prependContent(forcenetwork,htmltools::tags$h1("Interactive Node flow Origin to Destination by PA"))
forcenetwork
name_vec <- c(unique(flow2$from_PA), unique(flow2$to_PA))
print(flow2$from_PA)
print(name_vec)
#name_vec_from <-  lapply(name_vec, function(x) paste('to_', x))
#name_vec <- c(unique(name_vec))
#print(name_vec)
nodes <- data.frame(name = name_vec, id = 0:22)
#nodes_from$name <-  sapply(nodes$name, function(x) paste('from_', x))
#nodes_to$name  <-  sapply(nodes$name, function(x) paste('from_', x))
#nodes_from_to <- rbind(nodes_from, nodes_to)
#
class(flow2)
print(flow2)
#print(nodes_from_to)
print(class(flow2))
# links <- flow2 %>%
#   left_join(nodes, by = c('from_PA' = 'name'))  %>%
#   rename(from_PA = id) %>%
#   left_join(nodes, by = c('to_PA' = 'name')) %>%
#   rename(to_PA = id)
links <- flow2 %>%
left_join(nodes,flow2, by=c('from_PA'='name')) %>%
rename(from_PA_id = id) %>%
left_join(nodes,flow2, by=c('to_PA'='name')) %>%
rename(to_PA_id = id)
print(nodes)
print(class(nodes))
forcenetwork <- forceNetwork(Links = links, Nodes = nodes, Source = 'from_PA_id', Target = 'to_PA_id',
Value = 'Frequency_sqrt', NodeID = 'name', Group = 'id', zoom = TRUE)
forcenetwork <- htmlwidgets::prependContent(forcenetwork,htmltools::tags$h1("Interactive Node flow Origin to Destination by PA"))
forcenetwork
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
knitr::opts_chunk$set(echo = TRUE)
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")
name = "BUKIT BATOK","JURONG EAST"
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")
name = c("BUKIT BATOK","JURONG EAST")
node = as.dataframe(name)
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")
name = c("BUKIT BATOK","JURONG EAST")
node = data.frame(name)
sank_edge <- edges_data %>%
left_join(node,edges_data, by=c('planning_area.x'='name')) %>%
rename(from_id = id) %>%
left_join(node,edges_data, by=c('planning_area.y'='name' )) %>%
rename(to_id = id)
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")
name_vec = c("BUKIT BATOK","JURONG EAST")
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
sank_edge <- edges_data %>%
left_join(node_sank,edges_data, by=c('planning_area.x'='name')) %>%
rename(from_id = id) %>%
left_join(node_sank,edges_data, by=c('planning_area.y'='name' )) %>%
rename(to_id = id)
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")
name_vec = c("BUKIT BATOK","JURONG EAST")
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
sank_edge <- edges_data %>%
left_join(nodes_sank,edges_data, by=c('planning_area.x'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data, by=c('planning_area.y'='name' )) %>%
rename(to_id = id)
sank_edge
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")
name_vec = c("BUKIT BATOK","JURONG EAST")
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
sank_edge <- edges_data %>%
inner_join(nodes_sank,edges_data, by=c('planning_area.x'='name')) %>%
rename(from_id = id) %>%
inner_join(nodes_sank,edges_data, by=c('planning_area.y'='name' )) %>%
rename(to_id = id)
sank_edge
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")%>%
group_by("planning_area.x,planning_area.y") %>%
summarise(weight =sum(weight))
name_vec = c("BUKIT BATOK","JURONG EAST")
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
sank_edge <- edges_data %>%
inner_join(nodes_sank,edges_data, by=c('planning_area.x'='name')) %>%
rename(from_id = id) %>%
inner_join(nodes_sank,edges_data, by=c('planning_area.y'='name' )) %>%
rename(to_id = id)
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")%>%
group_by("planning_area.x,planning_area.y") %>%
summarise(weight =sum(weight))
edges_data
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")%>%
group_by("planning_area.x","planning_area.y") %>%
summarise(weight =sum(weight))
edges_data
name_vec = c("BUKIT BATOK","JURONG EAST")
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
sank_edge <- edges_data %>%
inner_join(nodes_sank,edges_data, by=c('planning_area.x'='name')) %>%
rename(from_id = id) %>%
inner_join(nodes_sank,edges_data, by=c('planning_area.y'='name' )) %>%
rename(to_id = id)
name_vec = c("BUKIT BATOK","JURONG EAST")
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
sank_edge <- edges_data %>%
inner_join(nodes_sank,edges_data, by=c('name'='planning_area.x')) %>%
rename(from_id = id) %>%
inner_join(nodes_sank,edges_data, by=c('name'='planning_area.y' )) %>%
rename(to_id = id)
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")%>%
group_by("planning_area.x","planning_area.y") %>%
summarise(weight =sum(weight))
edges_data
name_vec = c("BUKIT BATOK","JURONG EAST")
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
sank_edge <- edges_data %>%
inner_join(nodes_sank,edges_data, by=c('name'='planning_area.x')) %>%
rename(from_id = id) %>%
inner_join(nodes_sank,edges_data, by=c('name'='planning_area.y' )) %>%
rename(to_id = id)
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")%>%
group_by("planning_area.x","planning_area.y") %>%
summarise(weight =sum(weight))
edges_data
View(edges_data)
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")
View(edges)
View(edges_data)
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")
edges_data2 <- edges_data%>%
group_by("planning_area.x","planning_area.y") %>%
summarise(weight =sum(weight))
edges_data2
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")
edges_data2 <- edges_data%>%
group_by(planning_area.x,planning_area.y) %>%
summarise(weight =sum(weight))
edges_data2
name_vec = c("BUKIT BATOK","JURONG EAST")
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
name_vec = c("BUKIT BATOK","JURONG EAST")
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
sank_edge <- edges_data2 %>%
inner_join(nodes_sank,edges_data2, by=c('name'='planning_area.x')) %>%
rename(from_id = id) %>%
inner_join(nodes_sank,edges_data2, by=c('name'='planning_area.y' )) %>%
rename(to_id = id)
View(nodes_sank)
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('name'='planning_area.x')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('name'='planning_area.y' )) %>%
rename(to_id = id)
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('planning_area.x'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('planning_area.y'='name')) %>%
rename(to_id = id)
sank_edge
sank_edge %>% filter(planning_area.x %in% node_sank) %>% filter(planning_area.y %in% node_sank)
sank_edge %>% filter(planning_area.x %in% nodes_sank) %>% filter(planning_area.y %in% node_sank)
sank_edge %>% filter(planning_area.x %in% nodes_sank) %>% filter(planning_area.y %in% nodes_sank)
sank_edge %>% filter(planning_area.x %in% nodes_sank|| planning_area.y %in% nodes_sank)
sank_edge %>% filter(planning_area.x %in% nodes_sank)
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('planning_area.x'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('planning_area.y'='name')) %>%
rename(to_id = id)
sank_edge
sank_left <- sank_edge %>% filter(planning_area.x %in% nodes_sank)
sank_left
nodes_sank
sank_left <- sank_edge %>% filter(planning_area.x %in% nodes_sank$name)
sank_left
sank_left <- sank_edge %>% filter(planning_area.x %in% nodes_sank$name)  %>% filter(planning_area.y %in% nodes_sank$name)
sank_left
sankeyNetwork(Links = sank_left, Nodes = nodes_sank, Source = 'from_id', Target = 'to_id',
Value = 'weight', NodeID = 'name', fontSize = 16)
inputfrom = c('BUKIT BATOK')
inputto = c('JURONG EAST')
sank_left <- sank_edge %>% filter(planning_area.x %in% inputfrom)  %>% filter(planning_area.y %in% inputto)
sank_left
sankeyNetwork(Links = sank_left, Nodes = nodes_sank, Source = 'from_id', Target = 'to_id',
Value = 'weight', NodeID = 'name', fontSize = 16)
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")
edges_data2 <- edges_data%>%
group_by(subzone_origin,subzone_destination) %>%
summarise(weight =sum(weight))
edges_data2
name_vec = c('ROCHOR CANAL','CRAWFORD','REDHILL','ALEXANDRA HILL')
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('subzone_origin'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('subzone_destination'='name')) %>%
rename(to_id = id)
sank_edge
nodes_sank
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('subzone_origin'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('subzone_destination'='name')) %>%
rename(to_id = id)
sank_edge
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('subzone_origin'='name'))
sank_edge
sank_edge
sank_edge
sank_edge <- edges_data2 %>%
mutate(toupper(subzone_origin)%>%
left_join(nodes_sank,edges_data2, by=c('subzone_origin'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('subzone_destination'='name')) %>%
rename(to_id = id)
sank_edge <- edges_data2 %>%
mutate(toupper(subzone_origin))%>%
left_join(nodes_sank,edges_data2, by=c('subzone_origin'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('subzone_destination'='name')) %>%
rename(to_id = id)
sank_edge
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv") %>%
mutate(subzone_origin = toupper(subzone_origin)) %>%
mutate(subzone_destination = toupper(subzone_destination))
edges_data2 <- edges_data%>%
group_by(subzone_origin,subzone_destination) %>%
summarise(weight =sum(weight))
edges_data2
name_vec = c('ROCHOR CANAL','CRAWFORD','REDHILL','ALEXANDRA HILL')
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
nodes_sank
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('subzone_origin'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('subzone_destination'='name')) %>%
rename(to_id = id)
sank_edge
inputfrom = c('ROCHOR CANAL','CRAWFORD')
inputto = c('REDHILL','ALEXANDRA HILL')
sank_left <- sank_edge %>% filter(subzone_origin %in% inputfrom)  %>% filter(subzone_destination %in% inputto)
sank_left
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('subzone_origin'='name'))
sank_edge
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('subzone_origin'='name')) %>%
rename(from_id = id)
sank_edge
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('subzone_origin'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('subzone_destination'='name')) %>%
rename(to_id = id)
sank_edge
sank_edge <- edges_data2 %>%filter(subzone_origin %in% name)
sank_edge <- edges_data2 %>%filter(subzone_origin %in% nodes_sank$name)
sank_edge
sank_edge <- edges_data2 %>%filter(subzone_origin %in% nodes_sank$name) %>% filter(subzone_destination %in% nodes_sank$name)
sank_edge <- edges_data2 %>%filter(subzone_origin %in% nodes_sank$name)
sank_edge <- edges_data2 %>%filter(subzone_origin %in% nodes_sank$name) %>% filter(subzone_destination %in% nodes_sank$name)
sank_edge
sank_edge2 <- edges_data2 %>%filter(subzone_origin %in% nodes_sank$name) %>% filter(subzone_destination %in% nodes_sank$name)
sank_edge2
sank_edge <- left_join(nodes_sank , sank_edge2, by=c('subzone_destination'='name'))
sank_edge <- left_join(nodes_sank , sank_edge2, by=c('name'='subzone_destination'))
sank_edge <- left_join(nodes_sank , sank_edge2, by=c('name'='subzone_destination'))
sank_edge
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv") %>%
mutate(subzone_origin = toupper(subzone_origin)) %>%
mutate(subzone_destination = toupper(subzone_destination))
edges_data2 <- edges_data%>%
group_by(subzone_origin,subzone_destination) %>%
summarise(weight =sum(weight))
edges_data2
name_vec = c('ROCHOR CANAL','CRAWFORD','REDHILL','ALEXANDRA HILL')
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
nodes_sank
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('subzone_origin'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('subzone_destination'='name')) %>%
rename(to_id = id)
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('subzone_origin'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('subzone_destination'='name')) %>%
rename(to_id = id)
sank_edge
sank_left <- sank_edge %>% filter(subzone_origin %in% inputfrom)  %>% filter(subzone_destination %in% inputto)
sank_left
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv") %>%
mutate(subzone_origin = toupper(subzone_origin)) %>%
mutate(subzone_destination = toupper(subzone_destination))
edges_data2 <- edges_data%>%
group_by(subzone_origin,subzone_destination) %>%
summarise(weight =sum(weight))
edges_data2
name_vec = c('ROCHOR CANAL','CRAWFORD','REDHILL','ALEXANDRA HILL')
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
nodes_sank
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('subzone_origin'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('subzone_destination'='name')) %>%
rename(to_id = id)
sank_edge
inputfrom = c('ROCHOR CANAL','CRAWFORD')
inputto = c('REDHILL','ALEXANDRA HILL')
sank_left <- sank_edge %>% filter(subzone_origin %in% inputfrom)  %>% filter(subzone_destination %in% inputto)
sank_left
sankeyNetwork(Links = sank_left, Nodes = nodes_sank, Source = 'from_id', Target = 'to_id',
Value = 'weight', NodeID = 'name', fontSize = 16)
knitr::opts_chunk$set(echo = TRUE)
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv")
edges_data2 <- edges_data%>%
group_by(planning_area.x,planning_area.y) %>%
summarise(weight =sum(weight))
edges_data2
name_vec = c("BUKIT BATOK","JURONG EAST")
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('planning_area.x'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('planning_area.y'='name')) %>%
rename(to_id = id)
sank_edge
inputfrom = c('BUKIT BATOK')
inputto = c('JURONG EAST')
sank_left <- sank_edge %>% filter(planning_area.x %in% inputfrom)  %>% filter(planning_area.y %in% inputto)
sank_left
sankeyNetwork(Links = sank_left, Nodes = nodes_sank, Source = 'from_id', Target = 'to_id',
Value = 'weight', NodeID = 'name', fontSize = 16)
edges_data <- read_csv("data/origin_dest_Full_Aggregated_BusTrips.csv") %>%
mutate(subzone_origin = toupper(subzone_origin)) %>%
mutate(subzone_destination = toupper(subzone_destination))
edges_data2 <- edges_data%>%
group_by(subzone_origin,subzone_destination) %>%
summarise(weight =sum(weight))
edges_data2
name_vec = c('ROCHOR CANAL','CRAWFORD','REDHILL','ALEXANDRA HILL')
nodes_sank <- data.frame(name = name_vec, id = 0:(length(name_vec)-1)) %>%
mutate(id = as.numeric(id)) %>% mutate(name = as.character(name))
nodes_sank
sank_edge <- edges_data2 %>%
left_join(nodes_sank,edges_data2, by=c('subzone_origin'='name')) %>%
rename(from_id = id) %>%
left_join(nodes_sank,edges_data2, by=c('subzone_destination'='name')) %>%
rename(to_id = id)
sank_edge
# sank_edge2 <- edges_data2 %>%filter(subzone_origin %in% nodes_sank$name) %>% filter(subzone_destination %in% nodes_sank$name)
# sank_edge2
# sank_edge <- left_join(nodes_sank , sank_edge2, by=c('name'='subzone_destination'))
# sank_edge
inputfrom = c('ROCHOR CANAL','CRAWFORD')
inputto = c('REDHILL','ALEXANDRA HILL')
sank_left <- sank_edge %>% filter(subzone_origin %in% inputfrom)  %>% filter(subzone_destination %in% inputto)
sank_left
sankeyNetwork(Links = sank_left, Nodes = nodes_sank, Source = 'from_id', Target = 'to_id',
Value = 'weight', NodeID = 'name', fontSize = 16)
